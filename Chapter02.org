#+TITLE: Methods in Constructing the CN Stellate Microcircuit
#+DATE:
#+AUTHOR: Michael A Eager
#+OPTIONS: toc:nil H:5  <:t >:t tasks:nil
#+STARTUP: oddeven 
#+TODO: REFTEX
#+SEQ_TODO:   TODO(t) INPROGRESS(i) WAITING(w@) | DONE(d) CANCELED(c@)
#+TAGS:       Write(w) Update(u) Fix(f) Check(c) noexport(n)
#+LaTeX_CLASS: UoM-draft-org-article
#+LATEX_HEADER:\graphicspath{{../SimpleResponsesChapter/gfx/}{../figures/}{/media/data/Work/cnstellate/}{/media/data/Work/cnstellate/ResponsesNoComp/ModulationTransferFunction/}}
#+LATEX_HEADER:\setcounter{secnumdepth}{5}
#+LATEX_HEADER:\lfoot{\footnotesize\today\ at \thistime}
#+BIBLIOGRAPHY: MyBib alphanat



\setcounter{chapter}{1}
\chapter{Methods}\label{sec:MethodsChapter}

This chapter introduces the general methods used in the development and testing
of the \CNSM model.  More specific descriptions of the methods and procedures
used are provided in the relevant chapters.

* Prelude 							   :noexport:

#+begin_src emacs-lisp 
   (add-to-list 'org-export-latex-classes
                '("UoM-draft-org-article"
  "\\documentclass[12pt,a4paper,twoside,openright]{book}
   \\usepackage{../hg/manuscript/style/uomthesis}
   \\input{../hg/manuscript/user-defined}
   \\usepackage[acronym]{glossaries}
   \\input{../hg/manuscript/misc/glossary}
   \\makeglossaries
   \\pretolerance=150
   \\tolerance=100
   \\setlength{\\emergencystretch}{3em}
   \\overfullrule=1mm
  %%  \\usepackage[notcite]{showkeys}
   \\lfoot{\\footnotesize\\today\\ at \\thistime}
         [NO-DEFAULT-PACKAGES]
         [NO-PACKAGES]"
                  ("\\section{%s}" . "\n\\section{%s}")
                  ("\\subsection{%s}" . "\n\\subsection{%s}")
                  ("\\subsubsection{%s}" . "\n\\subsubsection{%s}")
                  ("\\paragraph{%s}" . "\n\\paragraph{%s}")
                  ("\\subparagraph{%s}" . "\n\\subparagraph{%s}")))
   (setq org-latex-to-pdf-process '("pdfquick  %f" ))
   (setq org-export-latex-title-command "\\singlespacing{\\tableofcontents\\printglossaries}")
#+end_src

#+RESULTS:
: \singlespacing{\tableofcontents\printglossaries}



* Auditory Input Model 

To understand the auditory system, one must first understand the transformations
preceding neural signals in the auditory nerve. Mechanical vibrations at the
eardrum (tympanic membrane) are conducted by the middle ear bones to vibrations
of fluid in the inner ear (cochlea). They are then transferred to chemical
signals in the inner hair cells and then to electrical potentials of the \ANFs. 


# \yellownote{needs references and further expansion.
#   Introduce new acronyms and keywords here eg. tonotopic.  Be careful not to
#   reproduce stuff done in the results chapters }

# This processing also enters a bottle-neck at the auditory nerve,
#  selectivity), referred to as `tonotopy'

\ANFs project to the \CN in a tonotopic fashion
\citep{Feldman:1969,Fekete:1984,Liberman:1991,LeakeSnyderEtAl:1993}. They
bifurcate after passing the central nervous system barrier to innervate the
ventral and dorsal portions of the cochlear nucleus (\VCN and \DCN), as shown in
Figure \ref{fig:CNCatHuman} \citep{Lorente:1981,Liberman:1991}. Based on their
cell bodies, myelination and prevalence, \ANFs are categorised as type I (large,
mylenated and highly prevalent) and type II (small, unmylenated and less
prevalent).  The dominant type I \ANFs are further categorised as \HSR and \LSR
fibres. \HSR fibres have a low threshold to tones and have limited dynamic range
(saturating to tones of moderate sound levels) \citep{SachsYoung:1979}.  \LSR
fibres have a higher threshold to stimulus sound level, and have a monotonic
response to increasing sound levels. \LSR fibres also project to the \GCD
\citep{Liberman:1993,RyugoParks:2003,RyugoHaenggeliEtAl:2003} along with the
smaller, unmyelinated type II ANFs \citep{HurdHutsonEtAl:1999}, which suggests
they play a different role in sound processing to \HSR fibres.


# Auditory processing enters an information bottle-neck at the auditory
# nerve. All \ANFs terminate in the \CN .  At this point, a group of highly
# specialised heterogeneous neurons in the \CN process the incoming information
# in several feature-based information pathways \citep{CantBenson:2003}. These
# include the high temporal acuity pathway (bushy cells); the onset detection
# pathway (octopus cells); the azimuth detection pathway (pyramid cells of the
# DCN); and the robust spectral pathway (\TS cells).
# \yellownote{GG understanding flow issues: 
# have included auditory nerve inputs with the appropriate features described
# above. The most recent \AN models include all observed phenomenological
# behaviours in \ANFs.  periphery models are necessary as inputs.  }

The abovementioned characteristics of \ANFs are essential as input to models of the \CN.
In examining the properties of a detailed neural model of the \CN,
 a phenomenologically-realistic auditory model was needed to represent
 sounds and transformations that occur in the central auditory system.
Simple attempts to recreate rate-level behaviour in \ANFs
\citep[e.g.~][]{SachsWinslowEtAl:1989} are not sufficient to reproduce complex
non-linear behaviours when dealing with arbitrary stimuli \citep{LeakeSnyderEtAl:1993,ArnesenOsen:1978,CloptonWinfieldEtAl:1974}.  
Since those early efforts, there has been great advancement in auditory periphery models; for an extensive review
see \citet{Lopez-Poveda:2005}.


The auditory nerve input model in the \CNSM\space model is called the Carney \AN model, where each version is derived from the original  
model of low \CF fibres \citep{Carney:1993}.  
#Motivated by observing ANF phenomena, 
Carney and colleagues have made improvements to their model over the last 20 years   
\citep{ZhangHeinzEtAl:2001,HeinzZhangEtAl:2001,BruceSachsEtAl:2003,ZilanyBruce:2006,ZilanyBruce:2007,ZilanyBruceEtAl:2009,ZilanyCarney:2010}.
#The Zhang model \citep{ZhangHeinzEtAl:2001}, the ARLO model \citep{HeinzZhangEtAl:2001} and the Bruce model
#\citep{BruceSachsEtAl:2003,ZilanyBruce:2006,ZilanyBruce:2007}, and the Zilany model \citep{ZilanyBruceEtAl:2009,ZilanyCarney:2010}.  
\citet{HeinzZhangEtAl:2001} incorporated cochlear filters based on
the critical bandwidths obtained from psychophysical experiments improving the non-linear compression and two-tone
suppression behaviour in the model. This model is used exclusively in Chapter \ref{sec:GAChapter}. 
\citet{ZilanyBruce:2007}, version 5, added a parallel signal control path and its predictions have matched a wide range of
physiological data in normal and impaired cat studies. Their most recent \AN
model  \citep[version~6][]{ZilanyBruceEtAl:2009} includes an additional power-law synapse model,
#, with internal fractional Gaussian noise,
which enhances the temporal recovery behaviour in \ANFs. 
Versions 5 \citep{ZilanyBruce:2007} and 6 \citep{ZilanyBruceEtAl:2009} of the Carney AN model are used in Chapters \ref{sec:Chapter3} and \ref{sec:Chapter4}.


#\citet{HeinzZhangEtAl:2001} incorporated cochlear filters based on
#the critical bandwidths obtained from psychophysical experiments in humans. 
#The \citet{ZilanyBruce:2007} model improved the previous AN model by an additional signal path and
#its predictions have matched a wide range of physiological data in normal and
#impaired cat data.

#Chapter \ref{sec:GAChapter} uses the ARLO model
#\citep{HeinzZhangEtAl:2001} and Chapters \ref{sec:Chapter3} and
#\ref{sec:Chapter4} use the Zilany model
#\citep{ZilanyBruceEtAl:2009,ZilanyCarney:2010}.
# \medskip{}

#  \yellownote{Why is it the cat model? updating Carney model?} Updating of the
#  Carney auditory model has led to the change in the model's configuration from an
#  original implementation of the rat model.  The default species is the cat and
#  will be used in the data presented in this chapter.


#+attr_latex: width=0.95\textwidth
#+caption: Auditory periphery schematic of the Zilany AN model (\citet{ZilanyBruceEtAl:2009}, reproduced from their Fig. 2). The AN model is comprised of a middle and inner ear filter model (A), and a synapse between inner hair cells and type I ANFs (B).  \citet{ZilanyBruceEtAl:2009} improved the classic IHC-AN synapse \citep{WestermanSmith:1987,WestermanSmith:1988} with dual power-law adaptation models and the inclusion of fractional Gaussian noise. Further details of the Zilany AN model are explained in \citet{ZilanyBruceEtAl:2009} and \citet{ZilanyCarney:2010}. 
#+label: fig:ZilanyBruceFig
[[../figures/ZilanyEtAl2009-Fig2.png]]


The Carney AN model consists of an outer/middle ear pre-processing filter, a cochlear filterbank,
\IHC to \AN synapse model and dead-time modified Poisson spike
generator. 
Figure \ref{fig:ZilanyBruceFig} shows the schematics of the Zilany version of the AN model
\citep{ZilanyBruceEtAl:2009,ZilanyCarney:2010}.



** Frequency Channels

The organisation of the auditory system is described as 'tonotopic' after the
continuous logarithmic frequency tuning along the basilar membrane
\citep{Greenwood:1990}.  The \CF of \ANFs is typical of the resonant frequency
of the adjacent basilar membrane
#\IHC 
and forms a topographical receptive field, according to place along the
central auditory nervous system.  

The input auditory model used in this thesis provides the major
phenomenological qualities of experimentally recorded \ANFs. The Zilany
model \citep{ZilanyBruceEtAl:2009} was based on many auditory models from
the Carney Lab
\citep{HeinzColburnEtAl:2001,ZhangCarney:2001,Carney:1993}.
 The centre
frequencies across  $N_{\rm channels}$ is determined by the logarithmic Greenwood
function \citep{Greenwood:1990} of the basilar membrane in cats. 
The model reproduces responses for 50 high and 30 low \SR \ANFs in each
frequency channel, across the frequency range 200 Hz to 64 kHz.


The range and number of frequency
channels in the auditory filterbank is defined in each of the proceeding
chapters. These parameters set the level of spatial resolution required in the
network model. Increases in the number of frequency channels greatly
increase the computational load and simulation time in the \AN input generation and \CNSM
models.

Centre frequencies of the channels were spaced logarithmically according to the
basilar membrane frequency-place map function, Equation
\ref{eq:Meth:Greenwood}, called the Greenwood function
\citep{Greenwood:1990}:
\begin{equation} \label{eq:Meth:Greenwood} 
f(x) = A \left(10^{ax/L} - k\right) \quad (Hz)
\end{equation} 
\noindent where /x/ is the distance along the basilar
membrane from the stapes, and variables /A/, /a/, /L/, and /k/ are dependent on the species.
The data listed in Table \ref{tab:Ch2:Greenwood} show the currently accepted
parameters for each species.

# \citep{FitzGeraldBurkittEtAl:2001}

# after \\: \hline or \cline{col1-col2} \cline{col3-col4} ...
#+caption: [Basilar membrane frequency-distance function parameters]{Frequency to basilar membrane distance function parameters. Data obtained from \url{http://earlab.bu.edu}.}
#+label: tab:Ch2:Greenwood
|                       |    *A* |   *a* |       *k* |  *L* |
|-----------------------+--------+-------+-----------+------|
| Human ^{\footnotesize 1} |  165.4 |   2.1 | 1.0(0.88) |   35 |
| Cat   ^{\footnotesize 2} |    456 |   2.1 |       0.8 |   25 |
| Rat  ^{\footnotesize 3}  | 7613.3 | 0.928 |       1.0 | 8.03 |
#+latex: {\footnotesize{$^1$ \citet{Greenwood:1990}, $^2$ \citet{Liberman:1982}, $^3$ \citet{Muller:1991}}}


** High and Low Spontaneous Rate Fibres

The level of spontaneous activity and minimum thresholds in \ANFs are
separated into two distinct groups, \HSR and \LSR fibres.  The \SR of
\HSR and \LSR was set to 50 and 0.5 Hz, respectively.
Twenty \HSR and ten \LSR \AN fibers were simulated
for each frequency-channel.
The stimulus was passed through the auditory nerve model for each
frequency channel for both \LSR and \HSR fibres, producing an
instantaneous firing rate response that was down sampled to 10 kHz.

# \yellownote{discuss ANF SR, types of ANF, long-term dependence, and
#   standard results of spiking models, and how Jackson then Zilany
#   have tried to fit these to the AN data}

The spiking neural model used in the auditory nerve fibres (and the Golgi cell model in
Chapters \ref{sec:Chapter3}-\ref{sec:Chapter4}) are inhomogeneous Poisson
processes with refractory effects. These properties are typical of auditory nerve fibres
\citep{Jackson:2003,JacksonCarney:2005}. 
Spike times were generated independently for each \HSR and \LSR fibre from the
instantaneous firing rate using a pseudo-random Poisson spike-generator
\citep{Jackson:2006,JacksonCarney:2005}, with refractory effects similar to those
present in \ANFs.  The double exponential relative refractory functions,
specific to ANFs, were:
\begin{eqnarray} 
y_0(t) = c_0*exp(-(t'-t_{\textrm{a}})/s_0) \\ 
y_1(t) = c_1*exp(-(t'-t_{\textrm{a}})/s_1) 
\end{eqnarray} 
\noindent where /t'/ is the time relative to the last
spike, $c_0 = 0.5$, $c_1 = 0.5$, $s_0 = 0.001$ ms, and $s_1 = 0.0125$
ms.  The absolute refractory period, $t_{\textrm{a}}$, was 0.75 ms.
#Improvements in the spike-generation method 
Spike trains for each neuron in the model were created at the start of each
repetition of the stimulus, but could be saved and loaded from file to improve
efficiency.

# \yellownote{Para: Notes from Hegger: discuss poisson generator} 
# # $$r(t) = \alpha [V(t)-V_{\mathrm th}]$$ 
# where 
# # $$\mathrm{P}\left{ n \mathrm{spike during}  (t_1,t_2)\right} = e^{\langle{}n\rangle}\frac{(\langle{}n\rangle)^n}{n!} \approx r(t)\delta{}t$$ then refractory effects; then renewal process PDF
# \begin{equation}  
# p(\tau) = (\kappa{}r)^{\kappa} \tau^{\kappa-1} e^{-\kappa{} r \tau} / (\kappa - 1)! 
# \end{equation}

# \yellownote{Real neuronal spike generation is highly reliable and deterministic, as has been demonstrated by countless numbers of \textit{in vitro} studies. }

# Complex time-varying currents, injected into neurons in rat cortex
# slices, resulted in spike trains were reproducible across repeats to
# less than 1 msec \citep{MainenSejnowski:1995}.  The noise in
# \textit{in vivo} neural responses is believed to result from the fact
# that synapses are very unreliable. In fact, greater than half of the
# arriving presynaptic nerve impulses fail to evoke a postsynaptic
# response \citep[e.g.,~][]{AllenStevens:1994}. The noise in the synapses,
# not in the spike generator!




# Analysis of the frequency
#  response area of ANF generates known parameters for each fibre, these are:
#  \begin{itemize} 
#  \item the spontaneous rate (SR), generated in silence and is
#    categoried into two groups High SR ($>$18 sp/s) and Low SR ($<$ 18
#    sp/s);
#  \item threshold, the sound pressure level(SPL) at which the cell
#    responds above the spontaneous rate
#  \item characteristic frequency (CF)
#  \end{itemize}
# \medskip{}




* Neural Cell Models
  :PROPERTIES:
  :LABEL: sec:Meth:cell-models
  :END:

# Hodgkin-Huxley-like
# \yellownote{Include discussion on HH-like neural models}
# Input resistance was calculated using [[latex:progname][NEURON]]'s /Impedence/ class by setting the input current frequency to 0 Hz[fn:: See input resistance function =rn()= in Appendix \ref{sec:Apdx:Utilities}.].


Single compartment conductance models, similar to those presented by 
\citet{HodgkinHuxley:1952a}, were used to model the cochlear nucleus
neurons. 
The dynamics of the membrane voltage, $V(t)$, is described by:
\begin{equation} \label{eq:Meth:V} 
C_{m} \frac{dV}{dt} = - \gleak (V - \Eleak) - \INa - \IKHT - \IKLT - \IKA - \Ih - \sum \ISYN
\end{equation} \noindent where $C_{m}$ is the specific membrane
capacitance; \gleak is the specific leak conductance with associated
leak reversal potential \Eleak; \INa is the sodium current density;
\IKHT, \IKLT, and \IKA are three types of potassium current densities; \Ih
is a hyperpolarization-activated current density; and \ISYN are synaptic
input current densities.  

The voltage dependent relationship in each current model has a peak conductance parameter and gating variables for activation and de-activation. 
The formula for the sodium current, \INa, was based on the studies of \citet{Costa:1996} and \citet{BelluzziSacchiEtAl:1985}
Belluzzi et al. (1985) and given by the following equation:
\begin{equation} \label{eq:Meth:INa} 
\INa(t,V)=\gNa m^{3} h (V - \ENa)
\end{equation} \noindent where /m/ is the activation function, /h/ is the de-activation function, \gNa is the maximum Na^{+} conductance, and 
(V - \ENa) is the relative potential between the membrane voltage and the 
Na^{+} reversal potential.
The sodium current in \VCN neurons has not been measured, but measurements in other mammalian neurons was deemed sufficient. 

The potassium and mixed-cation current models
used here are drawn from an investigation of isolated ventral \CN cells
/in vitro/ \citep{RothmanManis:2003,RothmanManis:2003a,RothmanManis:2003b}, which
yielded accurate mathematical descriptions of:
 - the high-threshold rectifying potassium current
   density: 
\begin{equation} \label{eq:Meth:IKHT} 
\IKHT(t,V)= \gKHT (\varphi n^{2} + (1-\varphi ) p)(V - \EK ) 
\end{equation}
 - the fast-activating transient potassium current
  density: 
\begin{equation} \label{eq:Meth:IKA} 
\IKA(t,V)=\gKA a^{4} b c (V -  \EK) 
\end{equation}
 - the low-threshold, fast-activating, slowly-deactivating potassium
   current density: 
\begin{equation} \label{eq:Meth:IKLT}
   \IKLT(t,V)=\gKLT w^{3} z (V-\EK) 
\end{equation}
 - the mixed-cation hyperpolarization-activated current
   density:
\begin{equation} \label{eq:Meth:Ih} 
\Ih(t,V)=\gh r (V-\Eh). 
\end{equation}

Figure \ref{fig:Ch2:RM2} 
The active voltage-dependant current
densities \INa, \IKHT, \IKLT, \IKA and \Ih, and each of their activation
and deactivation functions (/a, b, c, h, m, n, p, r, w/ and /z/) are
described in detail by \citet{RothmanManis:2003,RothmanManis:2003a,RothmanManis:2003b} and the [[latex:progname][NEURON]] source
code is freely available online at [[http://senselab.med.yale.edu/senselab/modeldb][ModelDB]] \citep{HinesMorseEtAl:2004}.
Detailed equations for the active voltage-dependant
currents $I_{Na}$, $I_{K_{HT}}$, $I_{K_{LT}}$, $I_{K_A}$ and $I_{h}$, and their
activation and de-activation functions are included in the appendix (Appendix \ref{sec:Apdx:RMCurrents})

#+attr_latex: width=0.7\textwidth
#+caption: [Voltage-dependancy of potassium channel dynamics in existing CN models]{\citet{RothmanManis:2003b} compared their kinematic model of activation gating variables of \IKLT and \IKHT with equivalent rectifying potassium channel models used by existing CN neural models. The voltage dependency of \IKHT's ($n^{\lambda},\, \tau_n$) and \IKLT's ($n^{\lambda},\, \tau_n$) activation gating variable and its time constant. This figure is reproduced from Figure 2 in \citet{RothmanManis:2003b}.}
#+label: fig:Ch2:RM2
[[../SimpleResponsesChapter/gfx/RothmanManisDynamics.pdf]]




**  Activation and Inactivation Variable Equations [APPENDIX]
   :PROPERTIES:
   :LABEL: sec:Apdx:RMCurrents
   :END:

The activation and inactivation variable equations are reproduced from \citet{RothmanManis:2003b}.
The core of the \HH-like current equations are the activation and inactivation variables. 
The time- and voltage-dependant current variables follow a first-order differential equation in time:
\begin{equation}
\frac{dx}{dt} = (x_\infty - x)/\tau_x
\end{equation}
where \tau_x is the time constant of /x/, $x_\infty$ is the steady-state value of /x/ (i.e.
the value of /x/ when $t \gg \tau_x$).

The voltage dependence of the activation and 
inactivation variables a, b, c, w, z, n, p, m, h, and r are shown in the following
equations. 
# Although the formalism of the preceding equation is different
# from the original HH formalism in which activation/inactivation vari-
# ables are expressed in terms of “open” and “close” rate constants \alpha
# and \beta, they are nevertheless mathematically equivalent when $x_\infty=\alpha/(\alpha + \beta)$ and 
# $\tau_x = 1/(\alpha + \beta)$. Reversal potentials are: \EK = -70 mV, 
# \ENa = +55 mV, 
# \Eh = -43 mV, and 
# \Eleak = -65 mV.

Fast transient K^{+} current
\begin{eqnarray}
\IKA(t,V) &=& \gKA  a^4 b c  (V - \EK) \\
a_\infty(V) &=& [1 +  \exp(-(V + 31)/6)]^{-1/4} \\
b_\infty(V) &=& [1 +  \exp((V + 66)/7)]^{-1/2} \\
c_\infty(V) &=& b_\infty
\end{eqnarray}
\begin{eqnarray}
\tau_a(V) &=& 100  [7  \exp((V + 60)/14) + 29  \exp(-(V + 60)/24)]^{-1} + 0.1 \\
\tau_b(V) &=& 1000  [14  \exp((V + 60)/27) + 29  \exp(-(V + 60)/24)]^{-1} + 1 \\
\tau_c(V) &=& 90  [1 +  \exp(-(V + 66)/17)]^{-1} + 10 
\end{eqnarray}

Low-threshold K^{+} current
\begin{eqnarray}
\IKLT(t,V) &=& \gKLT  w^4 z  (V - \EK) \\
w_\infty(V) &=& [1 +  \exp(-(V + 48)/6)]^{-1/4} \\
z_\infty(V) &=& (1 - \zeta)  [1 +  \exp((V + 71)/10)]^{-1} + \zeta \quad (\zeta = 0.5)
\end{eqnarray}
\begin{eqnarray}
\tau_w(V) &=& 100  [6  \exp((V + 60)/6) + 16  \exp(-(V + 60)/45)]^{-1} + 1.5\\
\tau_z(V) &=& 1000  [ \exp((V + 60)/20) +  \exp(-(V + 60)/8)]^{-1} + 50
\end{eqnarray}

High-threshold K^{+} current
\begin{eqnarray}
\IKHT(t,V) &=& \gKHT  [\phi n^2 + (1 - \phi)p] (V - \EK) \quad (\phi = 0.85)\\   
n_\infty(V) &=& [1 +  \exp(-(V + 15)/5)]^{-1/2} \\
p_\infty(V) &=& [1 +  \exp(-(V + 23)/6)]^{-1} 
\end{eqnarray}
\begin{eqnarray}
\tau_n(V) &=& 100  [11  \exp((V + 60)/24) + 21  \exp(-(V + 60)/23)]^{-1} + 0.7 \\
\tau_p(V) &=& 100  [4  \exp((V + 60)/32) + 5  \exp(-(V + 60)/22)]^{-1} + 5 
\end{eqnarray}


Fast Na^{+} current
\begin{eqnarray}
\INa(t,V) &=& \gNa  m^3 h (V - \ENa) \\
m_\infty(V) &=& [1 +  \exp(-(V + 38)/7)]^{-1} \\
h_\infty(V) &=& [1 +  \exp((V + 65)/6)]^{-1 }
\end{eqnarray}
\begin{eqnarray}
\tau_m(V) &=& 10 [5  \exp((V + 60)/18) + 36  \exp(-(V + 60)/25)]^{-1} + 0.04 \\
\tau_h(V) &=& 100 [7  \exp((V + 60)/11) + 10  \exp(-(V + 60)/25)]^{-1} + 0.6
\end{eqnarray}

Hyperpolarization-activated cation current
\begin{eqnarray}
\Ih(t,V) &=& \gh  r  (V - \Eh)\\
r_\infty(V) &=& [1 +  \exp((V + 76)/7)]^{-1}
\end{eqnarray}
\begin{equation}
\tau_r(V) =  10^5 [237  \exp((V + 60)/12) + 17  \exp(-(V + 60)/14)]^{-1} + 25\\
\end{equation}

Leak current
\begin{equation}
\Ileak = \gleak (V - \Eleak)
\end{equation}
#####



Membrane and synapse channels are temperature dependent and most /in vitro/
experiments are performed at room temperature, 22\degC.  All simulations in this
thesis were performed at body temperature, 37\degC. Accordingly modification of the
appropriate variables had to be performed. This included activation and
deactivation time constants, and maximum conductance of the currents.
Temperature scaling of each membrane current's activation and deactivation time
constant parameters was calculated with $Q_{10}=3.0$.  Maximum conductance
parameters, $\bar{g}$, were adjusted with temperature coefficient $Q_{10}=2.0$,
except for \Ih which had a temperature coefficient $Q_{10}=1.3$.

# ** Golgi Cell Model
# Inputs to Golgi cells are more complicated than the inputs to core \VCN
# neurons.  Golgi cells are sparse in the region surrounding the \VCN
# called the granule cell domain.  Extracellular recordings from labelled
# Golgi cells are not available in the literature; however, the \GCD (or
# marginal shell of the \VCN in cats) has been studied in only one study
# without direct labelling of recorded units \citep{GhoshalKim:1997}.  Any
# extracellular spikes recorded in the \GCD are most likely from Golgi
# cells since granule cell somata are less than 10 \um and their narrow
# axons are unlikely to elicit electrical activity in the electrodes.  The
# majority of recorded units showed a monotonic increase in firing rate
# with increasing sound intensity \citep{GhoshalKim:1997}.
# The Golgi cell model is implemented as an instantaneous-rate Poisson
# rate model.  The primary inputs are from the auditory model's
# instantaneous rate outputs with connections across frequency channels.
# \HSR and \LSR \ANF inputs to Golgi cells were specified by a Gaussian
# distribution in fibres across the network.  The weighted sum of \HSR and
# \LSR instantaneous-rate vectors were smoothed out by an alpha function
# mimicking a synaptic and dendritic smoothing filter.


# * Neural Models
#   :PROPERTIES:
#   :LABEL: sec:NeuralModels
#   :END:


** Neural Sub-types in the Cochlear Nucleus

\begin{figure}[h]
\includegraphics[width=\columnwidth,bb=0 0 206 175,clip]{../jneurometh/SimpleCircuit}
\caption{\label{fig:MicroCN} Microcircuit showing synaptic interaction within one
isofrequency lamina of the CN spanning the VCN and DCN. Spatial
organization of lateral connections in the CN stellate network are ordered into a range of frequency channels that is mapped
to the VCN and DCN from ANFs. }
\end{figure}


\yellownote{should you include CellMorph table here}

Table \ref{tab:Meth:CellTypes} shows the maximum conductances, $\bar{g}$,
for each cell type in the network.  The neurons in the ventral \CN
differ in their composition of these currents on the basis of their
current-clamp type. They are classified as either type I or type II
based on their response to intracellular current injection
\citep{OertelWuEtAl:1988}. The response of type I neurons to current
injection is regularly spaced \APs. \TV \citep{ZhangOertel:1993b} and
Golgi cells \citep{FerragamoGoldingEtAl:1998a} are classic type I, and
have \INa, \IKHT and \Ih currents. While \TS cells are type I, they have
additional A-type transient potassium channels, \IKA
\citep{FerragamoGoldingEtAl:1998,RothmanManis:2003b}. 

Type II responses
have only one phasic \AP at the start of the stimulus, characteristic of
ventral \CN bushy cells, which enables them to rapidly follow \ANF input
events \citep{OertelWuEtAl:1988,SmithRhode:1989}. \IKLT is present in
type-II units and is active at resting membrane potential, which allow
for rapid changes depending on the input. \DS cells respond with a
single \AP for injected current levels near threshold, and then discharge
regularly for higher current levels
\citep{OertelWuEtAl:1988,PaoliniClark:1999}, corresponding to an
intermediate type I-II response. \DS cells have a small amount of \IKLT
current to reduce the cells' input resistance and enhance coincidence
detection.  

In the \CNSM model, the membrane parameters were developed and refined after we
established the /in vitro/ characteristics of each cell type from the literature
\citep{FerragamoGoldingEtAl:1998,FerragamoGoldingEtAl:1998a,OertelWuEtAl:1988,ZhangOertel:1993b}
at 37\degC, and matched them to the model types in \citet{RothmanManis:2003}.
\yellownote{more discussion on the table}
#+BEGIN_LaTeX
  \begin{table}[tp]
    \centering
    \caption{Cell-type Membrane Current Parameters}\label{tab:Meth:CellTypes}
    \begin{tabularx}{0.8\linewidth}{lcccc}\toprule
             Cells            &  \TS   &  \DS   &   \TV   & Golgi \\ %\hline
      Current Clamp Model     &  I-t   &  I-II  &   I-c   & I-c \\[0.5ex] \midrule
       \gNa, S/cm$^{2}$       & 0.235  & 0.235  &  0.235  & 0.235 \\ %\hline
       \gKHT, S/cm$^{2}$      & 0.018  &  0.02  &  0.019  & 0.019 \\ %\hline
       \gKLT, S/cm$^{2}$      &   0    & 0.0047 &    0    & 0 \\ %\hline
       \gKA, S/cm$^{2}$       & 0.0153 &   0    &    0    & 0 \\ %\hline
       \gh, mS/cm$^{2}$       & 0.0618 & 0.247  & 0.06178 & 0.6178 \\ %\hline
      \gleak, mS/cm$^{2}$     & 0.471  & 0.471  &  0.471  & 0.962 \\ %\hline
      Soma Diameter, \um      &   21   &   25   &  19.5   & 15 \\ %\hline
  Input Resistance, M$\Omega$ &  163   &   73   &   170   & 130 \\ 
  \bottomrule
  \end{tabularx}
  \end{table}
#+END_LaTeX



* Connectivity and Organisation in the CNSM Model
   :PROPERTIES:
   :LABEL: sec:Ch2:ConnectivityandTopology
   :END:

Like many neural networks in the brain, the likelihood of
connectivity between two cells in the \CN is a function of distance,
cell type, and spatial spread relative to some receptive field.
Topographical connectivity in our model was based on position within
the \CN (Figure \ref{fig:Meth:MicroCN}B), but is easily interchangeable
with frequency-specific connectivity. Connectivity between cells in a
post-synaptic group onto individual cells is described by a synaptic
weight, /w/, the number of synapses, /n/, and the spatial spreading
parameter, /s/, which were taken to be uniform across the network for
each connection type.  The allocation of pre-synaptic cells to
post-synaptic cells was a random process modeled here using a Gaussian
function, with mean equal to the post-synaptic cell's \CF channel and
standard deviation equal to $\sqrt{s/2}$ (in channel units).  Connection
parameters that are fixed are shown in Table
\ref{tab:Meth:GeneralParams} and parameters used in the optimisation are
shown in Table \ref{tab:Meth:Genome}.

The basic unit of sensory networks is the place-channel or feature-channel of
the microcircuit, which separates the receptive field into independent
groups. The creation of neural microcircuits based on ``place'' is easily
amenable to different sensory neural network models; however there are problems
and unique features that may be necessary to ensure realistic representation of
the system.  In the \CNSM model, one iso-frequency channel  receives
afferent input from the narrowest receptive field possible in the auditory nerve
model.



Connection variables between cell types are generally uniform across the
network but may be adjusted to suit the model.  
In the \CNSM model, assumptions were made based on population average data.
# Model parameters may be
# different between species or within species, therefore, without adequate
# information regarding exact neuron to neuron connection reasonable
# assumptions are made based on the average population data.  
Issues arise
at the ends of large-scale topographic \BNNs with overlapping place\slash
channel connections.  Boundaries are considered closed bookends, where
post-synaptic neurons select only from those with its connection range.
The best modelling behaviour would arise, therefore, in the middle
sections.




** Network Connection Parameters

The probability of pre-synaptic to post-synaptic connection is defined
as a Gaussian probability distribution.  The distribution is centred on
the post-synaptic cell's position /i/ with an optional offset parameter,
/o/ in this case frequency channels.  Figure \ref{fig:MicrocircuitConn}
shows the method for Gaussian spread of connections between cell types
used throughout this thesis.

#  The channels are separated using the same Greenwood function as used for the AN filterbank.
#+BEGIN_LaTeX
  \begin{figure}[tbh]
    \begin{center}
  %    \resizebox{3.5in}{!}{\includegraphics[keepaspectratio=true]{NoFigure}}
    \resizebox{0.95\textwidth}{!}{\includegraphics[keepaspectratio=true]{../SimpleResponsesChapter/gfx/CNConn}}
  %     \resizebox{0.8\textwidth}{!}{\input{./gfx/CNConn.tex}}
      \caption[Distribution of synaptic connections]{Distribution of synaptic connections between cell types in the cochlear nucleus stellate microcircuit. A post-synaptic neuron receives $\mathbf{n}$ synapses from pre-synaptic neurons (from one cell-type group) with equal weight, $\mathbf{w}$. The post-synaptic cell is selected using a Gaussian random process, centred on the same frequency channel (with optional offset, $\mathbf{o}$) and spread equal to twice the variance.}
      \label{fig:MicrocircuitConn}
    \end{center}
  \end{figure}
#+END_LaTeX

Network parameters that control the connectivity between two cell-type
groups can be defined by:
- $\mathbf{w}_{\textrm{{X}}\to\textrm{{Y}}}$ ::  The synaptic weight of
     the post-synaptic current influx caused by the pre-cells'
     neurotransmitter activating the receptor channels of the
     post-synaptic cell.  This value may be either uniform for all
     synapses across the in this connection type or defined by a
     function of the receptive field.
- $\mathbf{n}_{\textrm{{X}}\to\textrm{{Y}}}$ :: The total number of synaptic connections on
     post-synaptic cells from  pre-synaptic cells.
- $\mathbf{s}_{\textrm{{X}}\to\textrm{{Y}}}$ :: The spatial or feature-specific
     spread of connections from presynaptic cells onto post-synaptic cells.  The
     spread parameter, /s/, is twice the variance of the Gaussian function, or
     standard deviation $\sigma = \sqrt{s/2}$. The distributions are uniform across
     the stellate CN network, which ignores channels outside the network's
     range.  A spread of 0 means all connections come from the same frequency
     channel, assuming no offset.
- $\mathbf{o}_{\textrm{{X}}\to\textrm{{Y}}}$ :: The offset in
     distribution of connections between pre-synaptic cell types and
     post-synaptic cells.  The offset variable adjusts the centre point
     of the probability distribution, $\mathcal{N}(i + \mathbf{o}, \sqrt{\mathbf{s}/2})$,
     away from the post-synaptic cell's position, /i/.
- $\mathbf{d}_{\textrm{{X}}\to\textrm{{Y}}}$ :: The temporal delay
     between a pre-synaptic cells' \AP trigger and the onset of the post-synaptic
     current.  This delay incorporates the axonal conduction delay and
     diffusion time across the synaptic cleft.  In a single-compartment
     model, additional delay can also be used to represent dendritic delay.



# New limitations of place-based connectivity

# The dendrites of \TS and \TV cells are located within isofrequency
# lamina of the \VCN and \DCN, respectively. The receptive field and
# bandwidth of \TS and \TV cells are also similar to \AN fibres of similar
# \CF.  In the CN stellate microcircuit, synapse inputs to these cells are
# chosen from \ANFs within the same frequency channel ($s=0$, see Table
# \ref{tab:Meth:GeneralParams}). \DS cells have many arborizations
# extending perpendicular to \ANF axons and have a typical physiological
# responses to frequencies 2 octaves below and 1 octave above their \CF
# \citep{PalmerJiangEtAl:1996,PaoliniClark:1999} (see fixed parameters in
# Table \ref{tab:Meth:GeneralParams}).  Physiological evidence in the
# golgi cell domain of the ventral \CN shows that neurons have monotonic,
# non-saturating rate-level curves, similar to \LSR \ANFs
# \citep{GhoshalKim:1996a}. \ANF labeling evidence shows the absence of
# \HSR \ANFs in the Golgi cell domain of the \CN
# \citep{Liberman:1991,Ryugo:2008,RhodeOertelEtAl:1983}, so the strength
# of Golgi excitation was given by \wLSRGLG and \nLSRGLG. Wide-band
# inhibition of \TV cells by \DS cells includes an additional channel
# offset, \oDSTV, to account for the asymmetry of wideband suppression
# found in \TV cells \citep{ReissYoung:2005}.  The offset was added to the
# Gaussian mean in the random allocation process.

The connectivity of the cell types involved in the stellate microcircuit is
shown in Figure \ref{fig:microcircuit} and in Table
\ref{tab:TSModelSummary}iii. \ANFs with similar characteristic frequencies were
spatially organised into $N_{\textrm{Channel}}$ iso-frequency lamina or channels,
which translated to frequency channels in the \CN.  Auditory nerve projections
to each \CN cell-type shared the same synaptic weight, $\mathbf{w}$, but \HSR and
\LSR fibres have different parameters encoding the number of inputs
(e.g. $\nHSRTS$, $\nLSRTS$).  Fast, glycinergic inhibition from \TV cells and
\DS cells (Figure \ref{fig:microcircuit}) was involved in modulating the firing
rate and spike interval variability in \TS cells
\citep{FerragamoGoldingEtAl:1998,WickesbergOertel:1993}. \TV cells in the deep
layer of the dorsal \CN provide a delayed narrowband inhibition to \TS and \DS
cells in the \VCN.  The dendrites of \DS cells cover one third of the
 \CN, contributing to this cell's wide frequency
response. In turn this cell is responsible for altering the frequency responses
in \TS and \TV cells \citep{SpirouDavisEtAl:1999}.  \DS cells are coincidence
detectors and have a precisely timed onset response that affects the temporal
properties of \TS cells \citep{PaoliniClareyEtAl:2005,RhodeGreenberg:1994a} and
completely inhibit \TV cell responses to loud clicks
\citep{SpirouDavisEtAl:1999}. GABAergic inhibition from Golgi cells modulates
the level of excitation necessary to reach threshold for all \CN cells
\citep{CasparyBackoffEtAl:1994,FerragamoGoldingEtAl:1998}.  Feedback circuits
from the olivary complex to the ventral \CN are also known to use \GABA as a
neurotransmitter \citep{SaintMorestEtAl:1989}, however this was not included the \CNSM
model.



** Synapse Models
   :PROPERTIES:
   :LABEL: sec:Ch2:Synapse
   :END:
Synapses were modeled with either a single or a double exponential
time-dependent conductance change.  The current density equation used was
\begin{equation}\label{eq:SYN}
\ISYN(t)=g_{{\rm SYN}} (t)  (V - E_{{\rm rev}}), 
\end{equation} \noindent where $E_{\rm rev}$ is the associated reversal
potential.  [[latex:progname][NEURON]]'s conductance synapse model classes /ExpSyn/ and
/Exp2Syn/ were used in the \CN stellate microcircuit \citep{HinesCarnevale:2000}.
The strength of the synapses was
determined by a normalised conductance kernel with decay
time-constants and a multiplicative weight parameter, /w/, as follows:
\begin{eqnarray}
\label{eq:Meth:11} g_{{\rm Exc}} (t) = w_{{\rm Exc}}  \exp(-t/\tau _{{\rm Exc}} ) \quad (\uS) \\
\label{eq:Meth:12} g_{{\rm Inh}} (t) = w_{{\rm Inh}} \,\eta\, \left( \exp(-t/\tau_{{\rm Inh2}} )- \exp(-t/\tau _{{\rm Inh1}} )\right) \quad (\uS) 
\end{eqnarray} \noindent where $\eta$ normalises the peak of the
double-exponential function to 1[fn:: Normalization factor for double
exponential synapse (\textit{exp2syn}) model
\citep{HinesCarnevale:2000}: $\eta =
\frac{1}{-\exp(t'/\tau_{Inh1})+\exp(t'/\tau_{inh2})}$ where
$t'=\frac{\tau_{Inh1}\tau_{Inh2}}{\tau_{Inh2}-\tau_{Inh1}} \ln(\tau_{Inh2}/\tau_{Inh1})$.].
  

\glsunset{AMPA} \glsunset{MNTB}
# AMPA does not need to be expanded here

Excitatory inputs to \CN cells from type-I \ANF terminals were mediated
by fast glutamatergic-\AMPA receptors
\citep{Gardner:2000,GardnerTrussellEtAl:1999}. \Glsplural{EPSP} in \VCN neurons
had a decay time constant of $\tAMPA = 0.36$ ms, whereas \TV cells in
the \DCN had a decay time constant of $\tAMPA = 0.40$ ms
\citep{GardnerTrussellEtAl:1999}.  The reversal potential of excitatory
synapse was 0 mV. 

\glsunset{GlyR}

Double exponential inhibitory synapses used in the network were derived from
\IPSPs in glycinergic and GABAergic synapses.  Glycinergic inhibitory synapses (with
receptor \GlyR) were modeled from glycinergic \IPSPs recorded in mature \CN and
\MNTB neurons. These synapses have a fast rise time, $\tGlyone = 0.4$ msec, and a decay
time constant $\tGlytwo = 2.5$ ms
\citep{AwatramaniTurecekEtAl:2005,HartyManis:1998,LeaoOleskevichEtAl:2004,LimOleskevichEtAl:2003}.
\GABAa synapses were modeled from \MNTB recordings in mature guinea pigs
\citep{AwatramaniTurecekEtAl:2005}.  \GABAa receptor currents have a fast (9 ms)
and a slow (150 ms) decay component
\citep{AwatramaniTurecekEtAl:2005,DavisYoung:2000}, but for short stimuli only
the fast component was modeled ($\tGABAone =0.7$ msec, $\tGABAtwo =9.0$
ms). Chlorine reversal potential in Glycine and \GABAa receptors was set to -75
mV.


** Delay and Latency Variables
   :PROPERTIES:
   :LABEL: sec:Ch2:DelayLatency
   :END:

For the \CNSM, delay is defined as the time between activation of the pre-synaptic neuron and
the activation of the post-synaptic potential, which includes axonal conduction
and synaptic diffusion (NEEDS REFERENCE). Synaptic transmission and axonal conductance delay
between adjacent neurons is typically measured in experiments to be between 0.4
to 0.5 ms. Delays between neurons in the ventral and dorsal \CN were measured
using electric shocks and found to be approximately 1.0 ms
\citep{WickesbergOertel:1993}.  
#\yellownote{Needs reference, and what about Bahlmer and Lagner's 0.4 ms delays}


Latency is defined in the \CNSM as the time difference between a stimulus of
reference event and the mean activation of the post-synaptic neuron.  The
formula for the latency of acoustic stimulation to the mean \FSL in \ANFs was
first derived by \citet{CarneyYin:1988} .  \citet{CarneyYin:1988} fitted
the \ANF first spike latency against the \CF of the fibres in cats from click responses
in the cat to obtain Equation \ref{eq:Meth:delay}:
\begin{equation} \label{eq:Meth:delay} 
d=A_{0} \exp(-x/A_{1})\times 10^{- 3} - 1/{\mathrm{CF}_x},
\end{equation} 
\noindent where /x/ is the distance along the basilar membrane from the apex, ${\mathrm{CF}}_x$ is
the \CF (Hz) at this location, and constants $A_0$
and $A_1$ are 8.3 ms and 6.49 cm for cats, respectively.
 
# In humans, \citet{HeinzZhangEtAl:2001} corrected the peak click to
# match the onset delay of ANFs, generating a latency function :
# \begin{equation} \label{eq:delayhumans} 
# d(x) = 4.915 + 0.3631 \times \exp(0.11324 \times x),\quad 5\, <\, x\, <\, 35 \quad (\mathrm{mm})
# \end{equation} 
#  where $A_0 = 3.0$, $A_1 = 12.5$. 
# the cat latency function was used in the rat \AN implementation has been retained in the model used here
# \citep{ZilanyBruceEtAl:2009}.

The latency of \CN neurons is not only affected by the properties of the basilar
membrane, but also by the twisting of axons by the spiral ganglion neurons and
the organised innervation of the \CN by the same fibres.  An additional delay
parameter is required that combines the intrinsic \ANF delay and the effective
axonal conductance to the \CN neurons.  Mean first spike latency to click
stimuli was used in Section \ref{sec:Ch3:Delay} to set the delay times between
\ANFs and \CN cells \citep{EagerGraydenEtAl:2006}.  The delay parameter was
fitted using the first spike latency of high frequency units as the sum of the
\ANFs' first spike latency, \ANF conduction delay, and the synaptic transmission
delay.
# \yellownote{My citation here is from ANS 2006.  }



* Simulation and Implementation of the CNSM Model 

** Simulation Environment

Neural models and network connections were generated using the neural
simulation package [[latex:progname][NEURON]] \citep{CarnevaleHines:2006}. NMODL, an
extension of [[latex:progname][NEURON]] \citep{HinesCarnevale:2000}, was used to implement
membrane current models and interface with the auditory nerve
model. Numerical integration was performed using the Crank-Nicholson
method with second order accuracy (in [[latex:progname][NEURON]] $secondorder=2$) and fixed
time step of either 0.1  or 0.05 ms. 


The computations of the NEURON model were distributed on a single
PC; a cluster of nine PCs (3.0 GHz Intel Pentium4);[fn::  Systems
provided by the Department of Otolaryngology, the University of
Melbourne] an SGI Altix system (=soma=: 64 32-bit Itanium
CPUs);[fn::  System =soma= provided by the Neuroimaging Group and
Department of Electrical and Electronic Engineering, the University of
Melbourne] and an iDataPlex IBM system (=merri=: 1024 64-bit Intel
x86 CPUs).[fn::  Sytem =merri= provided by the Victorian Life Sciences
Computing Initiative]


The parallel capabilities of the network model presented in Chapter
\ref{sec:Chapter3} were based on the NEURON network model [[latex:progname][netmod]] (see
other neural models that also use =netmod= at [[http://modeldb.senselab.yale.edu][ModelDB]], particularly
models [[http://senselab.med.yale.edu/senselab/modeldb/ShowModel.asp?model=52034][52034]], [[http://senselab.med.yale.edu/senselab/modeldb/ShowModel.asp?model=2730][2730]], and [[http://senselab.med.yale.edu/senselab/modeldb/ShowModel.asp?model=51781][51781]] \citet{MiglioreCanniaEtAl:2006}).
The genetic algorithms and sensitivity analyses in Chapter
\ref{sec:GAChapter} were implemented in [[latex:progname][C++]] using [[http://lancet.mit.edu/ga][GAlib]]
\citep{Wall:2006} and the PVM libraries
\citep{GeistBeguelinEtAl:1994}.

#The random numbers are required throughout this thesis in .
#generator used was the internal RNG of NEURON, MCellRand4


** Stimulus Generation

In order to emulate sound entering the ear, acoustic sounds were generated and 
passed into the auditory model.  The acoustic stimulus was generated in [[latex:progname][NEURON]],
with the exception of notch noise, which was generated in [[latex:progname][MATLAB/GNU
Octave]]. The stimulus types included pure tones, white noise, sinusoidal
amplitude modulated sounds and clicks.

# The first run of a stimulus may take some time if the AN responses have not been previously saved.  
The AN model described in \citet{ZilanyBruce:2007} requires a sampling
rate of 500 kHz in the stimulus.  The output of the AN model was then
down-sampled to a lesser resolution for the spike generator and saved
for further use.  The resolution of the spike generator was generally at
10 or 20 kHz to match the simulations' time step of 0.1 or 0.05 ms.
Version 4 of the AN model \citep{ZilanyBruceEtAl:2009} was sampled at
100 kHz for \CF units below 20 kHz, otherwise a sampling rate of 200 kHz
was used.

Notch noise was used as the stimulus for Chapter \ref{sec:GAChapter} and the optimisation of \DS cell connections
to \TV cells (see Section \ref{sec:Ch3:DSTV} in Chapter
\ref{sec:Chapter3}).  Notch noise was
generated from Gaussian white noise filtered using a stop-band filter in
[[latex:progname][MATLAB/GNU Octave]].  The notch noise sample was stored in a file so that
it could be retrieved by NEURON in the simulation.

#  with a
# 50 kHz sampling frequency and filtered with a quarter octave, 30 dB
# band-stop, 100-tap FIR filter centered at 5 kHz. A 50 ms stimulus was
# presented at 60 dB \SPL with 5 ms onset/offset ramps, a 20 ms delay and
# 10 ms pause after the stimulus. Notch noise stimuli have been used in
# experimental studies of the \CN to measure the asymmetric, wide-band
# suppression of \TV cells by \DS cells \citep{ReissYoung:2005} and to
# estimate the frequency range of \ANFs converging on \DS cells
# \citep{PalmerJiangEtAl:1996}.




** TODO Creation and Simulation  Model

The \AN model and the neural cell models were combined in a NEURON package called
[[latex:progname][cnstellate]].
#\yellownote{show organsisation of frequency channels, input and microcircuit }
The tonotopic organisation of the model was built into N_{\rm channel} frequency
channels (from $CF_{\rm low}$ to $CF_{\rm high}) mimicking the population of \ANF
input model. This replicates \ANF innervation of the \CN
\citep{Lorente:1981}.  The \CN stellate network model drawn in Figure
\ref{fig:microcircuit} describes the following cells and models:
1. Auditory nerve fibres :: The base line in Figure
     \ref{fig:microcircuit} is a simplification of \ANFs from low \CF to
     high \CF (left to right).  The model reproduces responses for high
     and low \SR \ANFs at a fixed number of frequency channels across the auditory range of the species being studied.
2. Golgi cells :: A \GABA-ergic \VCN marginal shell unit is assumed
     to regulate excitability in the \GCD and core \VCN units
     \citep{FerragamoGoldingEtAl:1998}.  Only one /in vivo/ study has
     recorded extracellular data in the marginal shell area of the \CN
     \citep{GhoshalKim:1997}.  The presumed characteristics of Golgi
     cells are taken from that study and are defined by a monotonic
     response to tones and noise, and an unusual or chopper \PSTH.
3. D stellate cells :: A large glycinergic multipolar cell with \OnC
      \PSTH response that acts as a coincidence detector.  Its large
     dendritic area increases its response to noise ,allowing it to
     behave as a wide-band inhibitor in the \VCN, \DCN, and
     contralateral \CN
     \citep{SmithMassieEtAl:2005,ArnottWallaceEtAl:2004,NeedhamPaolini:2007}.
4. Tuberculoventral cells :: A glycinergic, type II \EIRA unit in the
     deep layer of the \DCN \citep{SpirouDavisEtAl:1999}.  This cell
     acts as a delayed echo-suppressor and narrow-band inhibitor, with
     recurrent connections between D and T stellate cells in the \VCN
     \citep{Alibardi:2006,OertelWickesberg:1993,WickesbergWhitlonEtAl:1991}.
5. T stellate cells :: One of the major output projection cells of
     the \CN to the inferior colliculus.  This multipolar neuron has
     been shown to have robust spectral representation and enhanced
     synchronisation to modulation in speech sounds
     \citep{BlackburnSachs:1990,KeilsonRichardsEtAl:1997}.


\yellownote{Where is the figure?}

* Optimisation Techniques
  :PROPERTIES:
  :LABEL: sec:Ch2:Optimisation
  :END:


It is a laborious task to develop an accurate representation of complex
behaviour of real neural networks.  Pre-eminent computational neuroscientists
have noted that "choices, assumptions, and guesses" are an integral part of
neuronal modelling \citep{SegevBurkeEtAl:1998}.  The acceleration of
computational power and enhanced experimental techniques in multi-unit
recordings are enabling more detailed neural models to be developed.  There is
much to be gained from biophysically-realistic modelling approaches, especially
in the thoroughly investigated cochlear nucleus of mammals, bats and birds.

# \yellownote{See neural detail in auditory
# system\citep{LuRubioEtAl:2008}} \yellownote{Discuss use of Poisson
# models vs HH-like models.  Discuss single cell simulation vs whole
# network simulation during optimisation.}


\yellownote{Large parameter space
Biological realism vs. processing time
Portability to other neural systems
Population vs Single Neuron responses
Availability  and variability of experimental data
Variability in anaesthetics, type of animal}

\yellownote{
    Network Configuration
        Parameterisation
        Assumptions
    Constraining the Network
        Qualitative Data vs Model Driven
        Trade off - level of detail
}



To develop and optimise detailed neural models and their synaptic connections,
reproducible research methods are required. Hand-tuning and gradient-decent
optimisation is common in realistic neural and network models
\citep{SegevBurkeEtAl:1998}, but are unfavourable for repeatability. 
Examples of
parameter estimation and fitting in neural models are also becoming more
advanced, for example [[latex:progname][SSNS]] \citep{SichtigSchafferEtAl:2008}, [[latex:progname][NeuroFitter]]
\citep{VanAchardEtAl:2007} and [[latex:progname][MultiRunFitter]] (a feature in NEURON).  In this
thesis, a table method introduced by \citet{NordlieGewaltigEtAl:2009} is used to
summarise the neural models used in each optimisation step and improve
reproduction.  The Nordlie tables shown in each optimisation stage consist of (i)
the model summary; (ii) cell type populations; (iii) connectivity between two cell
types; (iv) neuron and synapse models; and (v) optimisation parameters.  This
method provides a consistent and recognisable format for presenting various
neural network models and their constituents.


#+LATEX: \input{../MethodsChapter/NordlieTemplate}
# \yellownote{this needs more explanation in the methods sections}

The standard methods for optimisation can be simply described with the
following steps:
 1. Specify the function or model we want to optimised.
 2. Specify the criteria to be satisfied.
 3. Specify the parameters that will be adjusted, and any constraints on
    those parameters.
 4. Perform the optimisation.
The large number of parameters in the \CNSM model creates a challenge
for a realistic optimisation.  The model implementation, the choice of
experimental data and evaluation of the fitness function are important
factors in determining the speed and efficiency of the algorithm.  The
following sections introduce the two optimisation methods used in this
thesis to characterise and hone in on a realistic model of the cochelar
nucleus stellate network.


** Sequential Methods

To create a realistic microcircuit from a wide range of
experimental data, Chapter \ref{sec:Chapter3} develops a parameter optimisation
routine in sequential stages.  The network parameters were chosen in the
sequential optimisation stages to encompass synaptic inputs to each individual
cell type in the CN stellate microcircuit. Chapter \ref{sec:Chapter3} uses the
praxis method, an algorithm for finding the minimum of a function of several
variables without needing the derivative \citep{Brent:1976}.

In developing and simulating the detailed neural models and neural network
models, a reproducible research method was used. The Nordlie approach
to reproducible neural network simulations
\citep{NordlieGewaltigEtAl:2009} is followed in Table
\ref{tab:ModelSummary}.  Tables \ref{tab:ModelSummary}i to \ref{tab:ModelSummary}v show the detailed summary of the \CN stellate
microcircuit used in the simulations performed in Chapter \ref{sec:Chapter3}.  



** Simultaneous Methods

Chapter \ref{sec:GAChapter} presents a method to optimise all the network
parameters simultaneously.  This method requires complete data from all neurons in
the network, and is therefore \yellownote{better explanation}  given existing experimental methods.

New techniques are being developed that are able to record from multiple neurons
simultaneously.

# - spike-timing essential, AIV ideal
The optimisation method used in Chapter \ref{sec:GAChapter} is a derivation of the genetic algorithm method \citep{Holland:1975,KozaRice:1991}.
 The genetic algorithm optimisation procedure uses operations analogous
 to natural selection to search for an optimum solution \citep{Mitchell:1996}.  This
 procedure is used when the standard analytical and gradient search
 methods are ineffective or computationally expensive.  The basic
 response properties of the neurons will be used to set the ‘fitness’
 criteria of the genetic algorithm.  The design and implementation of
 the genetic algorithm search method is discussed in the Chapter \ref{sec:GAChapter}.



#+BEGIN_LaTeX  
\ifthenelse{\isundefined{\manuscript}}{\newpage\singlespacing\bibliographystyle{plainnat} \bibliography{../hg/manuscript/bib/MyBib}\newpage \listoftodos}{}
#+END_LaTeX





# The network parameters (i.e. synapse distribution and strength) for
# each known projection will be constrained to physiologically
# significant responses using an iterative optimisation routine based on
# genetic algorithms.  The first stage of optimisation will use an
# isolated network of TS, DS and TV cells.  This stage will not include
# GABAergic input. The isolated network consists of TS cells restricted
# to one frequency channel and DS and TV cells connected from frequency
# channels on and off CF, Figure 9.  The second stage of optimisation
# will insert GABAergic input into the isolated network.  Including
# GABAergic inhibition will alter cell responses and therefore require
# adjustment of network parameters to properly account for physiological
# data.  The final stage of network development will be to combine a
# whole network of cells representing a range of frequencies that will
# be used to test the hypotheses.  The synaptic organisation of the
# expanded network will be based on the parameters of the isolated
# network.




# Figure 9: Isolated Network Model.  A single frequency channel of TS
# cells receiving a narrow band of ANF inputs.  TV and DS cells from
# same frequency channel and in lateral sidebands provide input to TS
# cells.  ANFs contact all cell types in frequency specific fashion.



# Genetic Algorithm design Genetic algorithms (GA’s) provide a
# stochastic global searching method that is most suitable for this
# task.  GA’s are derived from Charles Darwin’s theory of natural
# selection and employ operations analogous to genetic operations
# performed on DNA. The key concepts of GA’s are the parameter set, the
# fitness function and the termination criteria.  The set of parameters
# that we wish to optimise form a string of genes called an individual.
# A population of individuals makes up a generation. New generations are
# created by selecting the best of the population based on some fitness
# measure, then transforming the individuals by a genetic
# operation. Genetic operations allow for the best parameters to be
# retained and also introduce variety and randomness.  The fitness
# function quantifies in a single value how well the individual is
# suited to the environment.  The optimum solution in the genetic
# algorithm is a set of parameters that produce the smallest fitness
# function value.  The variables controlling the algorithm size and
# duration are set at the start of optimisation.  The number of
# individuals in a generation will be set to 100 and the maximum number
# of generations will be set to 20.  The best fitted individual will be
# the champion of that optimisation run.  Sanity checks on the parameter
# set will make sure the values are consistent and realistic.

# The major steps in preparing to use conventional genetic algorithms on fixed-length strings to solve a problem are (Goldberg, 1989):
# determining the representation scheme;
# determining the fitness measure;
# determining the parameters and variables for controlling the algorithms; and
# determining the way of designating the result and criterion for terminating a run.

# The representation scheme will use the parameters in Table 2 to create
# an individual of fixed length.  The fitness measure is discussed in
# detail in the next section.  The fitness will utilise a least squared
# error from the theoretical means of each of the constraint
# parameters. Physiological data from rate-level characteristics,
# synchronisation to amplitude modulated tones and lateral suppression
# observed in masked response curves will form the basis of the
# constraint parameters.  Termination will occur after a fixed number of
# generations or if an individual attains an excellent fitness value.

# The three steps in executing genetic algorithms on fixed length character strings can be summarised as follows (Goldberg, 1989):
# 1. Randomly generate an initial population of individual parameter sets. 
# 2. Iteratively perform the sub steps until the termination criteria is satisfied:
# a. Evaluate the fitness of each individual in the population
# b. Create a new population of strings by applying the operations below.  Select an individual with probability based on fitness.
# i. Reproduction: copy individual to next population.  This operation introduces conservation, to preserve the best-fitted individuals.
# ii. Cross-over: create two new individuals by randomly combining the substrings of two individuals broken at some random point.  This operation introduces variety but retains quality among existing parameter strings.
# iii. Mutation: create a new individual by taking one parameter in the set randomly select a new value. 
# 3. The best individual is the set of parameters that generate the best fitness value

# The methods used in the design and implementation of genetic algorithms come from Mitchell (1996) and Goldberg (1989).

# 	Fitness criteria

# 1) Rate-level curve (RLC)
#  The response to increasing intensity of tones at characteristic frequency (CF) is used to quantify a cell’s spontaneous rate, threshold, dynamic range and maximum discharge rate.  RLC’s are classified as monotonic, saturating or non-monotonic depending of their shape, Figure 10.  There is sufficient data on TS, DS and TV cells to obtain population statistics for each of the cell types.
# T stellate / Chopper cells: Gibson et al., 1985; Rhode and Smith, 1986; Young et al., 1988; Blackburn and Sachs, 1989; May and Sachs, 1992; Palmer et al., 2003;
# D stellate / Onset chopper cells: same as above plus Palmer et al., 1996; Arnott et al. 2004; 
# Tuberculoventral cells:  Shofner and Young 1985; Voigt and Young 1990; Spirou et al. 1999.  
# Golgi cells have received less attention because they are located in the marginal shell (Gibson et al. 1985; Ghoshal and Kim, 1997; Kim et al., 1998).
 
# Figure 10: Rate-level curves depicting saturating,  non-monotonic and monotonic characteristics.

		

# 2) Synchronisation to Amplitude modulated tones
# The synchronisation to AM tones has been discussed in the introduction.  Table 3: Physiological data used in the fitness function. shows the critical parameters in the tMTFs of stellate neurons that will be used to constrain parameters.
# 3) Lateral suppression in Masked Response Curves

# Cochlear nucleus neurons typically have low spontaneous rates, which
# makes detecting inhibition outside their response area difficult.  A
# masked response curve (MRC) utilises CF tones or noise to excite the
# cell to examine suppressive effects of off-CF tones. The MRC’s
# quantify the strength and bandwidth of lateral inhibition on TS cells
# and TV cells and facilitation in DS cells. Physiological recordings
# using MRC’s are used to constrain the network parameters (CF tone
# masker: Blackburn and Sachs, 1990; Noise masker: Rhode and Greenberg,
# 1994b; OnC facilitation: Palmer and Winter 1996).  Significant
# parameters from MRC’s are shown in Figure 11 along with recorded MRC’s
# from ChS and ChT units in the VCN (Rhode and Greenberg, 1994b)

# Figure 11: Left, description of masked response curve (MRC) parameters. Right, masked response curves using noise maskers in TS cells (ChT and ChS) from Rhode and Greenberg 1994.

# 	Fitness Function

# The physiological response characteristics that will be used to constrain the network are shown in Table 3.  These characteristics will be measured for each network parameter set (i.e. each individual in the genetic algorithm).  A fitness value will be assigned using a normalised least squared error procedure.  Equation 1 shows the fitness function F, for an individual X, with a summation of the least squared error for each constraint parameter.

# 				Eq. 1

# 	X = {xi}  where i = 1,2,3…N
# 	N   total number of constraint parameters
# 	 , mean experimental value for constraint parameter
# 	 , standard deviation from experimental mean.

	
# Table 3: Physiological data used in the fitness function.
# Physiological Property
# Contraint Parameters
# Range
# Reference
# Synchronisation to AM tones
# Shape
# Band-pass at high SPL, low-pass at low SPL
# Frisina et al 90a,b;
# Joris et al. 2003;
# Rhode, 1994;
# Rhode and Greenberg 1994a;

# BMF
# 100-500 Hz


# Cut-off
# 500-1000 Hz

# Rate-level curve (CF tone)
# Shape 
# Monotonic for DS, Saturating for TS, Non-monotonic for TV
# Gibson et al. 1985; Rhode and Smith 1986;
# Palmer et al. 2003; Arnott et al. 2004; Spirou et al. 1999;

# Dynamic range (10%-90% linear increase region)
# TS: 25-45 dB but can be higher
# DS: 60-80dB


# Threshold
# 0-30 dB SPL


# Max. Rate
# 300-400 spikes/sec

# Masked Response Curve  
# Masker induced rate
# ½ max rate  (100-200sp/s)
# Noise Masker: Rhode and Greenberg 1994b;
# CF tone masker:   Blackburn and Sachs 1992; Palmer and Winter, 1996; 

# Suppression Bandwidth (measured at 50% suppression rate)
# 4-5kHz


# Suppression Maximum
# 50-100% of masker induced rate


# ** Separation of Optimisation and Testing Data

# It is important to clarify the separation between physiological data
# used to constrain the network and data used to validate and test
# hypotheses.  The optimisation criteria represent responses to simple
# characteristics that are not directly related to complex response
# characteristics argued by the hypotheses.  The first three hypotheses
# relate to population responses of TS cells to spectrally and
# temporally complex signals such as vowels.  The rate-place and
# temporal representation of vowels provide a completely different set
# of test stimuli that is unrelated to the simple stimuli used for
# optimisation.  The fourth hypothesis relates to psychophysical
# masking, as detected from the threshold of spikes across the
# population of TS cells.  Simultaneous and forward masking experiments
# use simple tone and noise sounds as probes and maskers. The
# characteristic mechanisms for simultaneous masking are indirectly
# related to the lateral suppression mechanisms constrained by the
# optimisation process.  The detection of probe stimuli can utilise the
# responses across the whole population rather than the responses just
# at that frequency.  Hence, this hypothesis is testing the global
# response of a network that produces physiologically characterised
# lateral suppression at the individual cell level.  Forward masking
# uses stimuli separated in time, hence neither rate-level or masked
# response characteristics are related.  Synchronisation to AM tones
# does provide temporal constraints to parameters however this is
# unlikely to affect forward masking response directly.


### Local Variables:
### mode: org
### mode: visual-line
### fill-column: 72
### End:
